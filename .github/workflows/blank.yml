name: CI
on:
  push:
    branches: [ "main" ]
  workflow_dispatch:
jobs:
  create:
    runs-on: ubuntu-latest
    if: github.event.created
    steps:
      - run: echo Created!
  build-backend:
    runs-on: ubuntu-latest
    needs: create
    if: always() && (needs.create.result == 'skipped' || needs.create.result == 'success')
    steps:
      - run: echo Build backend
  build-frontend:
    runs-on: ubuntu-latest
    needs: create
    if: always() && (needs.create.result == 'skipped' || needs.create.result == 'success')
    strategy:
      matrix:
        include:
          - project: peugeot
          - project: peugeot_dealer
          - project: peugeot_finance
    steps:
      - run: echo Build ${{ matrix.project }}
  e2e-test:
    runs-on: ubuntu-latest
    needs: [build-backend, build-frontend]
    steps:
      - run: echo Build ${{ matrix.project }}
  deploy-backend:
    runs-on: ubuntu-latest
    needs: [e2e-test, build-backend]
    steps:
      - run: echo Deploy backend
